---
layout: default
title: Ãœbersicht
---

<h2>Zuletzt Besucht</h2>
<div class="liste" id="lastvisited-liste"></div>

<hr />

<h2>Alle Orte</h2>
<div class="liste" id="all_locations"></div>

<script>
  function show_lastvisited() {
    let lastvisited;
    try {
      lastvisited = JSON.parse(localStorage.getItem("lastvisited")) || [];
    } catch (e) {
      lastvisited = [];
    }

    let lastvisited_liste_div = document.getElementById("lastvisited-liste");
    lastvisited_liste_div.textContent = "";

    lastvisited.forEach((element) => {
      lastvisited_liste_div.appendChild(document.createElement("br"));

      let lastvisited_liste_a = document.createElement("a");
      lastvisited_liste_a.href = "/show?location=" + element.id;
      lastvisited_liste_div.appendChild(lastvisited_liste_a);
      lastvisited_liste_a.innerText = element.name;
    });
  }

  fetch("/locations.json")
    .then((response) => {
      if (response.ok) {
        return Promise.resolve(response);
      } else {
        return Promise.reject(new Error(response.statusText));
      }
    })
    .then((response) => {
      return response.json();
    })
    .then((data) => {
      let all_locations_div = document.getElementById("all_locations");
      data.forEach((location) => {
        let location_a = document.createElement("a");
        location_a.innerText = location.name;
        location_a.href = "/show?location=" + location.id;
        location_a.id = location.id;
        all_locations_div.appendChild(location_a);
        all_locations_div.appendChild(document.createElement("br"));
      });

      show_lastvisited();
    })
    .catch((error) => {
      console.log("Request failed", error);
    });

  window.addEventListener("pageshow", (event) => {
    if (
      event.persisted ||
      (typeof window.performance != "undefined" &&
        window.performance.navigation.type === 2)
    )
      show_lastvisited();
  });
</script>
